<!DOCTYPE html>
<html lang="en" data-base-url="{{baseUrl}}">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Cache Control Directives -->
  <meta http-equiv="Cache-Control" content="public, max-age=3600, must-revalidate">
  <meta http-equiv="Expires" content="Thu, 01 Jan 2025 12:00:00 GMT">
  <meta http-equiv="Pragma" content="cache">
  <meta http-equiv="Last-Modified" content="Mon, 01 Jan 2024 12:00:00 GMT">
  
  <meta name="keywords" content="{{keywords}}">
  <title>{{title}}</title>
  <!-- ✅ Canonical points to this page -->
  {{#if settings.site.url}}
    {{#eq page.path '/index.html'}}
      {{#eq baseUrl '/'}}
  <link rel="canonical" href="{{settings.site.url}}{{page.path}}">
      {{else}}
  <link rel="canonical" href="{{settings.site.url}}{{baseUrl}}">
      {{/eq}}
    {{else}}
      {{#eq baseUrl '/'}}
  <link rel="canonical" href="{{settings.site.url}}{{page.path}}">
   {{else}}
  <link rel="canonical" href="{{joinUrl settings.site.url (joinUrl baseUrl page.path)}}">
      {{/eq}}
    {{/eq}}
  {{else}}
  <link rel="canonical" href="{{baseUrl}}{{page.path}}">
  {{/if}}

  <!-- Open Graph / Facebook -->
  <meta property='og:type' content='website' />
  <meta property='og:title' content='{{title}}' />
  <meta property='og:description' content='{{settings.site.description}}' />
  <meta property='og:image' content='{{baseUrl}}og-image.png' />

  <!-- Twitter -->
  <meta property='twitter:card' content='summary_large_image' />
  <meta property='twitter:title' content='{{title}}' />
  <meta property='twitter:description' content='{{settings.site.description}}' />
  <meta property='twitter:image' content='{{baseUrl}}og-image.png' />
  <link rel="stylesheet" href="{{baseUrl}}mystyles.css?cachebrk={{cacheBreaker}}" type="text/css" />
  <script src="https://unpkg.com/lunr/lunr.js" defer></script>
  <script src="{{baseUrl}}mybundle.js?cachebrk={{cacheBreaker}}" defer></script>
  <link rel="stylesheet" href="{{baseUrl}}github-dark.min.css" type="text/css" />
  <link rel="icon" href="{{joinUrl baseUrl settings.site.favicon}}" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="180x180" href="{{baseUrl}}apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="{{baseUrl}}favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="{{baseUrl}}favicon-16x16.png">
  <link rel="manifest" href="{{baseUrl}}site.webmanifest">

  <script>
    // Define themes for light and dark modes
    const lightTheme = '{{settings.site.theme.light}}';
    const darkTheme = '{{settings.site.theme.dark}}';

    // Theme switcher functionality
    window.setTheme = function(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      
      // Close any open dropdowns
      const dropdowns = document.querySelectorAll('.dropdown-open');
      dropdowns.forEach(dropdown => dropdown.classList.remove('dropdown-open'));
      
      // Blur the button to remove focus
      if (document.activeElement) {
        document.activeElement.blur();
      }
    };
    
    // Hybrid theme system: manual choice persists, otherwise follows OS
    function setTheme(themeName) {
      // Manual theme selection - save to localStorage
      localStorage.setItem('theme', themeName);
      document.documentElement.setAttribute('data-theme', themeName);
      console.log('Manual theme set:', themeName);
    }
    
    function loadTheme() {
      const savedTheme = localStorage.getItem('theme');
      
      if (savedTheme) {
        // Use saved manual choice
        document.documentElement.setAttribute('data-theme', savedTheme);
        console.log('Using saved theme:', savedTheme);
      } else {
        // Follow OS preference
        const isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = isDark ? darkTheme : lightTheme;
        document.documentElement.setAttribute('data-theme', theme);
        console.log('Using OS theme:', theme, '(isDark:', isDark + ')');
      }
    }
    
    function resetToOSTheme() {
      // Clear manual choice and follow OS
      localStorage.removeItem('theme');
      loadTheme();
    }

    // Load theme immediately
    loadTheme();

    // Listen for OS theme changes (always override manual choice)
    if (window.matchMedia) {
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        const theme = e.matches ? darkTheme : lightTheme;
        // OS change always wins - save to localStorage and apply
        localStorage.setItem('theme', theme);
        document.documentElement.setAttribute('data-theme', theme);
        console.log('OS theme changed to:', theme, '- overriding any manual choice');
      });
    }
  </script>
</head>

<body class="bg-base-100" >
  <!-- Navbar -->
  <div class="navbar bg-base-100 border-b border-base-300 w-full sticky top-0 z-40">
    {{#unless layout.hideMenu}}
    <div class="flex-none lg:hidden">
      <label for="my-drawer-menu" aria-label="open sidebar" class="btn btn-square btn-ghost">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block h-6 w-6 stroke-current">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </label>
    </div>
    {{/unless}}
    <div class="flex-1 min-w-0 overflow-hidden">
      <a class="flex items-center min-w-0" href="{{joinUrl baseUrl 'index.html'}}">
          <img src="{{settings.site.logo}}" alt="{{settings.site.title}} Logo" class="w-5 h-5 mr-3 flex-shrink-0">
          <span class="text-xl font-mono font-bold truncate max-w-[40vw] sm:max-w-[50vw] md:max-w-[60vw] lg:max-w-none">{{title}}</span>
      </a>
    </div>
    
    {{#if settings.search.enabled}}
    <!-- Mobile search input - visible on mobile, hidden on desktop -->
    <div class="flex-none lg:hidden mr-2">
      <div class="dropdown dropdown-end">
        <input 
          id="search-mobile-navbar" 
          type="text" 
          placeholder="{{settings.search.placeholder}}" 
          class="input input-bordered input-sm w-32" 
          tabindex="0"
          oninput="handleSearch(this.value)" 
        />
        <ul id="search-results-mobile-navbar" class="dropdown-content bg-base-100 rounded-box z-[1] w-72 p-2 shadow hidden max-h-96 overflow-y-auto">
          <!-- Search results will be populated here -->
        </ul>
      </div>
    </div>
    {{/if}}
    
          <!-- Mobile theme switcher -->
      <div class="flex-none lg:hidden mr-2">
        <div class="dropdown dropdown-end">
          <div tabindex="0" role="button" class="btn btn-square btn-ghost text-base-content theme-toggle-btn" aria-label="Theme">
            <!-- Sun icon (visible in light theme) -->
            <svg class="h-6 w-6 fill-current theme-sun-icon transition-opacity" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/>
            </svg>
            <!-- Moon icon (visible in dark theme) -->
            <svg class="h-6 w-6 fill-current theme-moon-icon absolute transition-opacity opacity-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/>
            </svg>
          </div>
        <ul tabindex="0" class="dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow">
          <li><button onclick="setTheme('{{settings.site.theme.light}}')" class="justify-start">
            <svg class="h-5 w-5 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/>
            </svg>
            Light
          </button></li>
          <li><button onclick="setTheme('{{settings.site.theme.dark}}')" class="justify-start">
            <svg class="h-5 w-5 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/>
            </svg>
            Dark
          </button></li>
        </ul>
      </div>
    </div>
    
    <div class="hidden flex-none lg:flex lg:items-center lg:gap-4">
      <ul class="menu menu-lg menu-horizontal">
        <!-- Navbar menu content here -->          
          {{#each navbar}}
            <li><a href="{{#if this.url}}{{joinUrl baseUrl this.url}}{{else}}{{joinUrl baseUrl this.document}}{{/if}}">{{this.title}}</a></li>
          {{/each}}
      </ul>
      {{#if settings.search.enabled}}
      <div class="dropdown dropdown-end">
        <input 
          id="search-desktop" 
          type="text" 
          placeholder="{{settings.search.placeholder}}" 
          class="input input-bordered w-24 md:w-auto" 
          tabindex="0"
          oninput="handleSearch(this.value)" 
        />
        <ul id="search-results" class="dropdown-content bg-base-100 rounded-box z-[1] w-96 p-2 shadow hidden max-h-96 overflow-y-auto">
          <!-- Search results will be populated here -->
        </ul>
      </div>
      {{/if}}
      
      <!-- Desktop theme switcher -->
      <div class="dropdown dropdown-end">
        <div tabindex="0" role="button" class="btn btn-square btn-ghost text-base-content theme-toggle-btn" aria-label="Theme">
          <!-- Sun icon (visible in light theme) -->
          <svg class="h-6 w-6 fill-current theme-sun-icon transition-opacity" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/>
          </svg>
          <!-- Moon icon (visible in dark theme) -->
          <svg class="h-6 w-6 fill-current theme-moon-icon absolute transition-opacity opacity-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/>
          </svg>
        </div>
        <ul tabindex="0" class="dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow">
          <li><button onclick="setTheme('{{settings.site.theme.light}}')" class="justify-start">
            <svg class="h-5 w-5 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/>
            </svg>
            Light
          </button></li>
          <li><button onclick="setTheme('{{settings.site.theme.dark}}')" class="justify-start">
            <svg class="h-5 w-5 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/>
            </svg>
            Dark
          </button></li>
        </ul>
      </div>
    </div>
    
  </div>
  <div class="drawer {{#unless layout.hideMenu}}lg:drawer-open{{/unless}}">
    {{#unless layout.hideMenu}}
    <input id="my-drawer-menu" type="checkbox" class="drawer-toggle" />
    {{/unless}}
    <div class="drawer-content flex flex-col">
      <!-- Page content here -->
      <div class="{{#unless layout.fullWidth}}lg:pl-80{{/unless}}">
        {{#block "main"}}
        {{/block}}
      </div>      
    </div>
    {{#unless layout.hideMenu}}
    <div class="drawer-side z-50">
      <label for="my-drawer-menu" aria-label="close sidebar" class="drawer-overlay"></label>
      <ul id="sidebar-menu" class="menu menu-md bg-base-100 min-h-full w-80 lg:mt-6 p-4 lg:pt-0 lg:pb-20 lg:overflow-y-auto lg:fixed lg:top-12 lg:h-[calc(100vh-3rem-4rem)]">
        <!-- Mobile menu items -->
        <div class="lg:hidden mb-4">
          {{#if settings.search.enabled}}
          <div class="dropdown dropdown-top w-full">
            <input 
              id="search-mobile" 
              type="text" 
              placeholder="{{settings.search.placeholder}}" 
              class="input input-bordered w-full mb-4" 
              tabindex="0"
              oninput="handleSearch(this.value)" 
            />
            <ul id="search-results-mobile" class="dropdown-content bg-base-100 rounded-box z-[1] w-full p-2 shadow hidden max-h-96 overflow-y-auto">
              <!-- Search results will be populated here -->
            </ul>
          </div>
          {{/if}}
          <li><a href="{{joinUrl baseUrl 'index.html'}}">Home</a></li>
          <!-- Navbar menu content here -->          
          {{#each navbar}}
            <li><a href="{{#if this.url}}{{joinUrl baseUrl this.url}}{{else}}{{joinUrl baseUrl this.document}}{{/if}}">{{this.title}}</a></li>
          {{/each}}
          <div class="divider"></div>
        </div>
        <!-- sidebars -->        
        {{#each sidebars}}
          {{menuNode this activeDocId=../page.path}}
        {{/each}}
        
      </ul>
    </div>
    {{/unless}}
  </div>
  {{#unless layout.hideFooter}}
  <footer class="footer footer-center text-base-content p-4">
    {{#if footer}}
    <div class="footer-content">
      {{#each footer}}
      <div class="footer-section">
        {{#if title}}<h3 class="footer-title font-bold mb-2">{{title}}</h3>{{/if}}
        {{#if items}}
        <nav class="flex flex-wrap gap-4 justify-center">
          {{#each items}}
          <a href="{{#if this.url}}{{joinUrl baseUrl this.url}}{{else}}{{joinUrl baseUrl this.document}}{{/if}}" class="link link-hover">{{this.label}}</a>
          {{/each}}
        </nav>
        {{/if}}
      </div>
      {{/each}}
    </div>
    
    {{else}}
    <aside>
      <p>This site was created with <a href="https://jbeejones.github.io/okidoki-website/index.html" class="link link-hover">OkiDoki</a> - Copyright © {{copyright.year}}</p>
    </aside>
    {{/if}}
  </footer>
  {{/unless}}
</body>

</html>